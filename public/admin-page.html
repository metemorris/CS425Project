
<html>
	<head>
		<title> Admin Page</title>
		<link href="Styles/style2.css" rel = "stylesheet" />
		<link rel="icon" href="Images/m.png">
        <script src="Scripts/alert.js"></script>
        <script src="Scripts/jquery-3.1.1.js"></script>

        <script>
            //list all admins on below textbox
             var listAdmins = function(){
             $.get(
                "/admin",
                {},
                function(data){
                    var list = document.getElementById('list');
                    $("#list").empty();
                    for(element in data) {
                        var elem = document.createElement("li");
                        elem.innerHTML = data[element]['Admin_ID']+ ": " + data[element]['Password'];
                        list.appendChild(elem);
                    }
                })
            }
            var listStudents = function(){
             $.get(
                "/admin/students",
                {},
                function(data){
                    var list = document.getElementById('list');
                    $("#list").empty();
                    for(element in data) {
                        var elem = document.createElement("li");
                        elem.innerHTML =  "Name: "+data[element]['First_Name']+" " + data[element]['Last_Name']+" | ID:  "+data[element]['Student_ID']+" | Password:  "+data[element]['Password'];
                        list.appendChild(elem);
                    }
                })
            }

            var listTeachers = function(){
             $.get(
                "/admin/teachers",
                {},
                function(data){
                    var list = document.getElementById('list');
                    $("#list").empty();
                    for(element in data) {
                        var elem = document.createElement("li");
                        elem.innerHTML =  "Name: "+data[element]['First_Name']+" " + data[element]['Last_Name']+" | ID:  "+data[element]['ID']+" | Password:  "+data[element]['Password'];
                        list.appendChild(elem);
                    }
                })
            }


            var listParents = function(){
             $.get(
                "/admin/parents",
                {},
                function(data){
                    var list = document.getElementById('list');
                    $("#list").empty();
                    for(element in data) {
                        var elem = document.createElement("li");
                        elem.innerHTML =  "Name: "+data[element]['First_Name']+" " + data[element]['Last_Name']+" | ID:  "+data[element]['ParentGuardian_ID']+" | Password:  "+data[element]['Password'];
                        list.appendChild(elem);
                    }
                })
            }


            var listBooks = function(){
             $.get(
                "/admin/books",
                {},
                function(data){
                    var list = document.getElementById('list');
                    $("#list").empty();
                    for(element in data) {
                        var elem = document.createElement("li");
                        elem.innerHTML =  "Name: "+data[element]['Name']+" | ID:  "+data[element]['ISBN']+" | Total Number:  "+data[element]['Total_Number']+" | Number Checked Out:  "+data[element]['No_Checked_Out'];
                        list.appendChild(elem);
                    }
                })
            }

            var signOut = function() {
                localStorage.removeItem('id');
                window.location.href = '/index.html';
            }


            var addAdmin = function() {
                const id = document.getElementById("adminid").value;
                const pass = document.getElementById("adminPass").value;
                const inp = {
                    admin_id: id,
                    password: pass
                };
                $.post(
                "/admin",
                inp,
                function(data){
                    alert(data);
                })
            }

            var deleteX = function() {

                $.ajax({
                    url: "/admin/" + document.getElementById("deleteadminid").value,
                    type: 'DELETE',
                    success: function(result) {
                        // Do something with the result
                        console.log("Deleted");
                    }
                });
            }

            var updateX = function() {
                const id = document.getElementById("updateadminid").value;
                const pass = document.getElementById("updatePass").value;
                const inp = {
                    admin_id: id,
                    password: pass
                };
                $.post(
                "/admin/password",
                inp,
                function(data){
                    alert(data);
                })
            }

            var loginPage= function(){
                window.location.href = 'index.html';
            }

            var searchBook = function () {
                $.get(
                    "/librarybook/bookname/" + document.getElementById('search-name').value ,
                    {},
                    function(data){
                        alert(JSON.stringify(data));
                        var list = document.getElementById('booklist');
                        $("#booklist").empty();
                        for(element in data) {
                            var elem = document.createElement("li");
                            var div = document.createElement("div");
                            var btn = document.createElement("button");
                            var inp = document.createElement("input");
                            var inp2 = document.createElement("input");
                            inp.type = "number";
                            inp.placeholder = "Enter student id: ";
                            inp2.type = "text";
                            inp2.placeholder = "2017-12-31";
                            div.innerHTML =  "Name: "+data[element]['Name']+" | ID:  "+data[element]['ISBN']+" | Total Number:  "+data[element]['Total_Number']+" | Number Checked Out:  "+data[element]['No_Checked_Out'];
                            btn.innerHTML = "Check";
                            btn.addEventListener('click', function () {
                                var postdata = {ISBN: data[element]['ISBN'], bookname: data[element]['Name'], student_id: parseInt(inp.value), bookid: data[element]['School_ID'], due_date: inp2.value};
                                $.post(
                                    "/student/checkoutbook",
                                    postdata,
                                    function(data){
                                        alert('You have Checked Out The Book successfully!');
                                    });
                            });
                            elem.appendChild(div);
                            elem.appendChild(inp);
                            elem.appendChild(inp2);
                            elem.appendChild(btn);
                            list.appendChild(elem);
                        }
                    })
            }
        </script>

	</head>
	<body>
		<script src="login.js"></script>

		<h1> ADMIN PAGE </h1>

        <button onclick="listAdmins()"> Display All Admins </button>
        <button onclick="listStudents()"> Display All Students </button>
        <button onclick="listTeachers()"> Display All Teachers </button>
        <button onclick="listParents()"> Display All Parents </button>
        <button onclick="listBooks()"> Display All Books </button>
        <button onclick="signOut()"> Sign Out </button>
        <!-- place to print the display options -->
        <ul id="list"> </ul>
        <h2>Add New Admin: </h2>
        <form name="newAdmin">
            Administrator ID: <input type="text" name="userid" id="adminid"/>
            Password: <input type="password" name="pswrd" id="adminPass"/>
            <input type="button" onclick="addAdmin()" value="Add Admin"/>
            <input type="reset" value="Cancel"/>
        </form>
        <h2>Delete Admin: </h2>
         <form name="deleteAdmin">
            Administrator ID: <input type="text" name="userid" id="deleteadminid"/>
            <input type="button" onclick="deleteX()" value="Delete Admin"/>
        </form>
        <h2>Update Admin: </h2>
        <form name="updateAdmin">
            Administrator ID: <input type="text" name="userid" id="updateadminid"/>
            New Password: <input type="password" name="pswrd" id="updatePass"/>
            <input type="button" onclick="updateX()" value="Update Password"/>
        </form>
        <button class="btn btn-primary" name="Go to Login page" onclick="loginPage()">Go to Login page </button>

    <h2>
        Search For Book:
    </h2>
        <input type="text" id="search-name"/>
        <button type="button" onclick="searchBook()"> Search </button>
        <ul id="booklist"></ul>
    </body>
</html>
